# Система сбора и анализа внутриигровых данных

## Назначение

Настоящий проект представляет собой полнофункциональную систему для генерации, хранения и анализа внутриигровых данных, имитирующих активность игроков в многопользовательской ролевой игре (MMORPG). Цель разработки — демонстрация реализации сквозного data pipeline, включающего компоненты генерации, хранения, визуализации и аналитики.

Проект предназначен для использования в учебных целях и может служить основой для изучения принципов работы с потоковыми данными, инструментами визуализации и средствами анализа поведения пользователей в цифровой среде.

---

## Архитектура системы

Система построена на микросервисной архитектуре с использованием Docker Compose для оркестрации контейнеров. Все компоненты взаимодействуют через внутреннюю сеть, что обеспечивает изолированность и масштабируемость.

### 1. Генератор игровых событий (Python)

Генератор реализован как отдельный сервис на языке Python. Основные характеристики:

- **Частота генерации**: одна запись на каждого игрока каждые 3 секунды.
- **Количество игроков**: 5 (`player_id` от 1 до 5).
- **Типы событий**:
  - Атака (`attack`)
  - Убийство (`kill`)
  - Отдых (`rest`)
- **Показатели**:
  - Нанесённый урон (`damage_dealt`)
  - Полученный опыт (`experience_gained`)
  - Использованная способность (`ability_used`)
  - Продолжительность игровой сессии (`session_duration_sec`)
  - Тип врага (`enemy_type`)
- **Реалистичное поведение**:
  - Игрок сохраняет текущее действие минимум 5 секунд.
  - Переход между состояниями происходит с учётом уровня персонажа.
  - Значения урона и опыта соответствуют балансу типичной MMORPG.
- **Автоматизация**: сервис запускается автоматически при старте системы через Docker Compose.

### 2. База данных: PostgreSQL

Для хранения данных используется реляционная СУБД PostgreSQL. Все игровые события сохраняются в таблице `game_events`.

#### Структура таблицы `game_events`

| Поле | Тип | Описание |
|------|-----|----------|
| `id` | `SERIAL PRIMARY KEY` | Уникальный идентификатор записи |
| `timestamp` | `TIMESTAMP DEFAULT NOW()` | Время фиксации события |
| `player_id` | `INTEGER` | Идентификатор игрока (1–5) |
| `enemy_type` | `VARCHAR(50)` | Тип противника (Goblin, Orc и др.) |
| `damage_dealt` | `INTEGER` | Нанесённый урон |
| `experience_gained` | `INTEGER` | Полученный опыт |
| `ability_used` | `VARCHAR(50)` | Использованная способность |
| `session_duration_sec` | `INTEGER` | Длительность действия (в секундах) |
| `event_type` | `VARCHAR(50)` | Тип события (attack, kill, rest) |

Таблица создаётся автоматически при первом запуске с помощью SQL-скрипта `init.sql`.

### 3. Визуализация: Redash

Для визуализации данных используется платформа Redash

Дашборд содержит следующие элементы:

1. **Сводка по игрокам**  
   Общие метрики: урон, опыт, количество действий, время игры.

2. **Общий урон по игрокам**  
   Столбчатая диаграмма для сравнения эффективности игроков.

3. **Рост опыта во времени**  
   Линейный график, отражающий прогресс игроков.

4. **Эффективность способностей**  
   Горизонтальная диаграмма, сравнивающая средний урон по способностям.

5. **Убийства по типу врага**  
   Диаграмма, показывающая распределение убийств.

Адрес веб-интерфейса: [http://localhost:5000](http://localhost:5000)

> Для входа в систему используются тестовые учетные данные:  
> **Email:** `admin@example.com`  
> **Пароль:** `Bastard_04`

### 4. Анализ данных: Jupyter Notebook

Дополнительно к визуализации в Redash, в проекте представлен файл `notebooks/analysis.ipynb` — Jupyter Notebook, содержащий исследовательский анализ данных.

#### Функционал ноутбука:
- Подключение к базе данных PostgreSQL через SQLAlchemy.
- Загрузка и предварительная обработка данных с использованием `pandas`.
- Построение графиков с помощью `matplotlib`:
  - Рост опыта по времени
  - Эффективность способностей
  - Активность игроков по часам
- Интерпретация результатов и выводы.

---

## Инструкция по развёртыванию

### Предварительные требования

Перед началом работы необходимо установить:

- [Docker Desktop](https://www.docker.com/products/docker-desktop/) — для оркестрации контейнеров
- Git — для клонирования репозитория (опционально)

### Шаги по запуску

1. **Клонирование репозитория**

```bash
git clone https://github.com/lizaesakova/data-system.git
cd data-system
```

2. **Запуск системы**

В корневой директории проекта выполните команду:

```bash
docker-compose up --build
```

> Первый запуск может занять несколько минут. После завершения инициализации генератор начнёт писать данные в консоль.

3. **Доступ к интерфейсам**

- **Redash**: откройте в браузере [http://localhost:5000](http://localhost:5000)
- **Jupyter Notebook** (по желанию):
  ```bash
  cd notebooks
  python -m notebook
  ```

Для завершения работы нажмите `Ctrl + C` в терминале. Чтобы очистить все данные (включая историю), выполните:

```bash
docker-compose down --volumes
```

## Автор

Есакова Елизавета Б9123-01.03.02ии1

Проект выполнен в рамках учебного задания.  
**Выполнил:** [Укажите ваше имя]  
**Дата:** декабрь 2025 г.
